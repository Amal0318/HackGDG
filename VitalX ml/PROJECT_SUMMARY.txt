â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                â•‘
â•‘               VitalX - SEPSIS PREDICTION MODEL                 â•‘
â•‘                    PhysioNet 2019 Aligned                      â•‘
â•‘                                                                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PROJECT DELIVERABLES CHECKLIST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… PHASE 1 â€” DATA PREPROCESSING
   âœ“ Load patient PSV files (training_setA & training_setB)
   âœ“ Forward-fill missing values per patient  
   âœ“ Add missingness mask features (13 indicators)
   âœ“ Normalize numeric features (StandardScaler)
   âœ“ Dataset split: train / validation / test
   âœ“ Create sliding windows (24-hour sequences)
   âœ“ Handle class imbalance (weighted BCE)

âœ… PHASE 2 â€” FEATURE SELECTION
   âœ“ Core Vitals (8): HR, O2Sat, Temp, SBP, MAP, DBP, Resp, EtCO2
   âœ“ Key Labs (5): Lactate, WBC, Creatinine, Platelets, Bilirubin_total
   âœ“ Demographics (2): Age, Gender
   âœ“ Derived Features (6):
     â€¢ ShockIndex = HR / SBP
     â€¢ HR_delta, SBP_delta, ShockIndex_delta
     â€¢ RollingMean_HR, RollingMean_SBP
   âœ“ Missingness Indicators (13): Binary masks for vitals & labs
   
   ğŸ“Š TOTAL FEATURE COUNT: 34 features

âœ… PHASE 3 â€” MODEL ARCHITECTURE (PyTorch)
   âœ“ Input â†’ LSTM (2 layers, hidden=128, dropout=0.3)
   âœ“ Attention Layer (learns temporal importance)
   âœ“ Fully Connected Layers (128â†’64â†’1)
   âœ“ Sigmoid output (probability)
   âœ“ ~300K trainable parameters

âœ… PHASE 4 â€” TRAINING
   âœ“ Loss: Weighted Binary Cross Entropy
   âœ“ Metrics: AUROC, AUPRC, Sensitivity, Specificity
   âœ“ Early stopping (patience=7)
   âœ“ Model checkpointing
   âœ“ Best model saving
   âœ“ Learning rate scheduling

âœ… PHASE 5 â€” MODEL EXPORT
   âœ“ model.pth - Trained model weights
   âœ“ scaler.pkl - Feature normalization scaler
   âœ“ feature_config.json - Feature specifications

âœ… PHASE 6 â€” INFERENCE WRAPPER
   âœ“ SepsisPredictor class
   âœ“ predict(sequence_tensor) â†’ probability
   âœ“ predict_batch() for multiple patients
   âœ“ predict_from_patient_file() for PSV files
   âœ“ No FastAPI, No Kafka (model-only)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

FILE STRUCTURE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Core Implementation:
â”œâ”€â”€ config.py              - Feature definitions & hyperparameters
â”œâ”€â”€ dataset.py             - Data loading & preprocessing (343 lines)
â”œâ”€â”€ model.py               - LSTM + Attention architecture (256 lines)
â”œâ”€â”€ train.py               - Training loop with early stopping (252 lines)
â”œâ”€â”€ evaluate.py            - Comprehensive evaluation (262 lines)
â”œâ”€â”€ inference.py           - Production inference wrapper (340 lines)
â”œâ”€â”€ utils.py               - Metrics & utility functions (199 lines)
â””â”€â”€ main.py                - Complete pipeline orchestration (244 lines)

Documentation:
â”œâ”€â”€ README.md              - Comprehensive documentation
â”œâ”€â”€ QUICK_REFERENCE.py     - Quick start guide
â””â”€â”€ requirements.txt       - Python dependencies

Data:
â””â”€â”€ training/
    â”œâ”€â”€ training_setA/     - Patient PSV files (p000001.psv, ...)
    â””â”€â”€ training_setB/     - Additional patient data

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

USAGE EXAMPLES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. COMPLETE PIPELINE (Recommended)
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   python main.py
   
   # Quick test with subset
   python main.py --subset

2. INDIVIDUAL SCRIPTS
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   # View features
   python config.py
   
   # Train only
   python train.py
   
   # Evaluate only (requires trained model)
   python evaluate.py
   
   # Inference examples
   python inference.py

3. PROGRAMMATIC USAGE
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   from inference import SepsisPredictor
   import numpy as np
   
   # Initialize
   predictor = SepsisPredictor()
   
   # Predict from sequence (24 hours Ã— 34 features)
   sequence = np.random.randn(24, 34)
   probability = predictor.predict(sequence)
   
   # Predict from patient file
   prob, seq = predictor.predict_from_patient_file(
       'training/training_setA/p000001.psv'
   )
   
   # Batch prediction
   sequences = np.random.randn(10, 24, 34)
   probs = predictor.predict_batch(sequences)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

MODEL SPECIFICATIONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Architecture:     LSTM with Attention
Input Shape:      (batch, 24, 34)
Output Shape:     (batch, 1)
Hidden Size:      128
LSTM Layers:      2
Dropout:          0.3
Attention:        âœ… Enabled
Bidirectional:    âŒ Disabled

Training:
  Batch Size:     32
  Learning Rate:  0.001
  Max Epochs:     50
  Early Stopping: 7 epochs
  Optimizer:      Adam
  Loss:           Weighted BCE
  Scheduler:      ReduceLROnPlateau

Data:
  Sequence:       24 hours
  Train/Val/Test: 70% / 15% / 15%
  Class Weights:  Auto-computed from data

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

EVALUATION METRICS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Primary:
  â€¢ AUROC  - Area Under ROC Curve
  â€¢ AUPRC  - Area Under Precision-Recall Curve

Secondary:
  â€¢ Sensitivity (Recall)
  â€¢ Specificity
  â€¢ Precision
  â€¢ F1 Score
  â€¢ Utility Score (PhysioNet 2019 metric)

Visualizations:
  â€¢ ROC Curve
  â€¢ Precision-Recall Curve
  â€¢ Threshold Analysis
  â€¢ Confusion Matrix

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

KEY FEATURES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ“ No future data leakage
âœ“ Hour-by-hour predictions
âœ“ 6-hour early warning target
âœ“ Handles class imbalance
âœ“ Missing value imputation
âœ“ Missingness indicators
âœ“ Feature engineering (shock index, deltas, rolling means)
âœ“ Attention mechanism
âœ“ Early stopping
âœ“ Model checkpointing
âœ“ Comprehensive evaluation
âœ“ Clean modular structure
âœ“ Production-ready inference

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

OUTPUTS (after training)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

outputs/
â”œâ”€â”€ model.pth                    â† Trained PyTorch model
â”œâ”€â”€ scaler.pkl                   â† Feature scaler
â”œâ”€â”€ feature_config.json          â† Feature specifications
â”œâ”€â”€ training_history.json        â† Training metrics
â”œâ”€â”€ test_evaluation.json         â† Test performance
â”œâ”€â”€ plots/
â”‚   â”œâ”€â”€ roc_curve.png           â† ROC curve
â”‚   â”œâ”€â”€ pr_curve.png            â† Precision-Recall curve
â”‚   â””â”€â”€ threshold_analysis.png   â† Threshold sensitivity
â””â”€â”€ checkpoints/
    â””â”€â”€ checkpoint_epoch_*.pth   â† Epoch checkpoints

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

INSTALLATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

pip install -r requirements.txt

Required:
  â€¢ Python 3.8+
  â€¢ PyTorch 2.0+
  â€¢ NumPy, Pandas, Scikit-learn
  â€¢ Matplotlib (for plots)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TROUBLESHOOTING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Issue: "No data directories found"
Fix:   Ensure training/training_setA exists with PSV files

Issue: "Model not found" during evaluation
Fix:   Train model first: python train.py

Issue: Out of memory during training
Fix:   Reduce BATCH_SIZE in config.py (try 16 or 8)

Issue: Poor model performance
Fix:   â€¢ Verify data quality and labels
       â€¢ Check class imbalance weights
       â€¢ Increase training data
       â€¢ Tune hyperparameters in config.py

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TECHNICAL HIGHLIGHTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. MISSINGNESS HANDLING
   â€¢ Indicators created BEFORE forward-fill
   â€¢ Preserves clinical information about missing data
   â€¢ Critical for sepsis prediction

2. FEATURE ENGINEERING
   â€¢ ShockIndex: Cardiovascular stress indicator
   â€¢ Delta features: Capture trends over time
   â€¢ Rolling means: Smooth noisy vital signs
   â€¢ All derived features based on clinical rationale

3. ATTENTION MECHANISM
   â€¢ Learns which hours in 24-hour window are important
   â€¢ Improves interpretability
   â€¢ Enhances early detection

4. CLASS IMBALANCE
   â€¢ Weighted loss based on class distribution
   â€¢ Ensures model learns minority class (sepsis)
   â€¢ Evaluated with AUPRC (better for imbalanced data)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PROJECT STATUS: âœ… COMPLETE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

All phases implemented according to specifications:
âœ“ Data preprocessing pipeline
âœ“ Feature engineering (34 features)
âœ“ LSTM model with attention
âœ“ Training with early stopping
âœ“ Comprehensive evaluation
âœ“ Production inference wrapper
âœ“ Clean modular architecture
âœ“ Full documentation

Ready for training and deployment!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Built with PyTorch â€¢ Clinical ML â€¢ VitalX 2026
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
