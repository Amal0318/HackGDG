# ðŸš€ Quick Setup Guide - Alert System

## Step 1: Get Gemini API Key (FREE)

1. **Visit:** https://makersuite.google.com/app/apikey
2. **Click:** "Create API Key"
3. **Copy** your API key (starts with `AIza...`)

**Model:** We use `gemini-1.5-flash` (low-tier, fast, cheap for text generation)

---

## Step 2: Setup Gmail for Email Alerts

### Option A: Gmail App Password (Recommended)

1. **Enable 2-Step Verification:**
   - Go to: https://myaccount.google.com/security
   - Enable "2-Step Verification"

2. **Create App Password:**
   - Visit: https://myaccount.google.com/apppasswords
   - Select "Mail" and "Other (Custom name)"
   - Name it: "ICU Alert System"
   - Copy the 16-character password

3. **Use in `.env`:**
   ```env
   SMTP_USERNAME=your-email@gmail.com
   SMTP_PASSWORD=abcd efgh ijkl mnop  # The app password
   ALERT_EMAIL_TO=doctor-email@gmail.com
   ```

### Option B: Other Email Providers

**Outlook/Hotmail:**
```env
SMTP_SERVER=smtp-mail.outlook.com
SMTP_PORT=587
```

**Yahoo:**
```env
SMTP_SERVER=smtp.mail.yahoo.com
SMTP_PORT=587
```

---

## Step 3: Create `.env` File

```bash
cd icu-system/alert-system
copy .env.example .env
# Edit .env with your keys
```

**Minimum Required:**
```env
GEMINI_API_KEY=AIzaSy...your-key-here
GEMINI_MODEL=gemini-1.5-flash

ENABLE_EMAIL_ALERTS=true
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password
ALERT_EMAIL_TO=doctor@hospital.com
```

---

## Step 4: Test It!

```bash
# Start the complete system
cd icu-system
docker compose up -d

# Check alert-system logs
docker logs icu-alert-system -f
```

---

## ðŸ“§ Email Alert Example

When a high-risk patient is detected, you'll receive:

**Subject:** `ðŸš¨ CRITICAL ALERT - Patient P2-003 (2F)`

**Body:**
```
ICU EMERGENCY ALERT
============================================================

Severity: CRITICAL
Patient: P2-003
Floor: 2F
Time: 2026-02-14 23:45:30

============================================================

CRITICAL Alert Assessment:

Key Findings:
- Heart rate critically elevated at 145 bpm (35% above baseline)
- Severe shock index of 1.61 indicating circulatory compromise
- Blood pressure trending downward with systolic at 90 mmHg
- SpO2 at 89% indicating hypoxemia

Recommended Action:
Immediate bedside assessment required. Consider:
- Fluid resuscitation for shock
- Oxygen supplementation for hypoxemia
- Cardiac monitoring
- Possible ICU transfer if not already in critical care

Clinical Reasoning:
The combination of tachycardia, hypotension (indicated by high
shock index), and hypoxemia suggests acute deterioration
potentially due to sepsis, hypovolemia, or cardiac compromise.

============================================================

Generated by LangChain + Gemini Flash AI
DO NOT REPLY TO THIS EMAIL
```

---

## ðŸ”§ Troubleshooting

### "Authentication failed" (Email)
- Check if 2-Step Verification is enabled
- Use App Password, not your regular password
- Check for typos in SMTP_USERNAME/PASSWORD

### "GEMINI_API_KEY not set"
- Make sure `.env` file exists (not `.env.example`)
- Check the file is in `alert-system/` folder
- Restart docker container after updating `.env`

### No alerts triggered
- Check if patients are high-risk: `docker logs icu-pathway-engine`
- Lower threshold in `config.py`: `HIGH_RISK_THRESHOLD = 0.5`
- Check Kafka is running: `docker ps | grep kafka`

---

## ðŸ’° Cost Estimates (10-15 hour demo)

- **Gemini Flash:** FREE (60 requests/min limit)
- **Gmail:** FREE
- **Railway deployment:** ~$2-5 total

---

## ðŸŽ¯ For Demo

**Show judges:**
1. âœ… Real-time email alerts to doctor
2. âœ… AI-generated medical analysis (Gemini)
3. âœ… Professional HTML email formatting
4. âœ… Multi-patient monitoring across 3 floors
5. âœ… LangChain automation layer

**Demo tip:** Use your own email as doctor email to show real-time notification!
